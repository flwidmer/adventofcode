Foldl' is strict, maybe that helps some for part 2

Association list didn't do well enough. 

So Trying again with Map.

If that does not work: Hashmap

Hashmap does not work either. Maybe IntMap.Strict